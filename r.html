<!doctype html>
<html>
<body>Redirecting...</body>
<script>
  const p = new URLSearchParams(location.search);

  const clientid  = p.get("clientid");
  const recruiter = p.get("recruiter");
  const user      = p.get("u");     // email or response id
  const bookings  = p.get("b");     // encoded bookings url

  // log click
  fetch("https://default7f3bafd4fd464630a4cbb725c91e39.19.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/3ff180cbb38249d0a003448e86f0f939/triggers/manual/paths/invoke?api-version=1", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      clientid, recruiter, user,
      clickedAt: new Date().toISOString()
    })
  }).catch(()=>{});

  // redirect to the recruiterâ€™s bookings page
  window.location.replace(bookings);
</script>
</html>
