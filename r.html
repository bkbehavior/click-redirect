
 
<html>
<head><meta charset="utf-8"><title>Flow POST Test</title></head>
<body>Testing Power Automate trigger (POST)…</body>

<script>
  const FLOW_URL = "https://default7f3bafd4fd464630a4cbb725c91e39.19.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/3ff180cbb38249d0a003448e86f0f939/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=G_RNyDf5mGRMdmCInYD1ZpIgX_i8maVdxOvKf5MtPeo"; // full URL incl. sig=

  // Static test payload (must match your flow schema keys)
  const payload = {
    clientid: "TEST123",
    recruiter: "TEST_RECRUITER",
    user: "test@email.com",
    bookings: "https://example.com",
    clickedAt: new Date().toISOString()
  };

  // sendBeacon sends a POST without CORS/preflight headaches
  const ok = navigator.sendBeacon(
    FLOW_URL,
    new Blob([JSON.stringify(payload)], { type: "application/json" })
  );

  const pre = document.createElement("pre");
  pre.textContent = "POST sent: " + ok + "\n\nPayload:\n" + JSON.stringify(payload, null, 2);
  document.body.appendChild(pre);

  document.body.insertAdjacentHTML(
    "beforeend",
    "<p>Now check the flow <b>Run history</b>. If you see no run, the URL is wrong or the trigger isn’t reachable.</p>"
  );
</script>
</html>
